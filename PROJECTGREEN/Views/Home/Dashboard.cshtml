@{
    Layout = "~/Views/Shared/_MainLayout.cshtml";
    ViewData["Title"] = "Babag EcoHub: Dashboard";
    var adminNote = ViewBag.Announcements as AdminNote;
    string announcementMessage = "";
    if (adminNote != null)
    {
        announcementMessage = adminNote.Subject + ": " + adminNote.Note;
    }
}

<style>
    .metric-card {
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 20px;
        margin-bottom: 20px;
    }

        .metric-card h5 {
            font-weight: bold;
            color: #4CAF50;
        }
</style>
<!-- Carousel Start -->
<div class="container-fluid carousel-header vh-100 px-0">
    <div id="carouselId" class="carousel slide" data-bs-ride="carousel">
        <ol class="carousel-indicators">
            <li data-bs-target="#carouselId" data-bs-slide-to="0" class="active"></li>
            <li data-bs-target="#carouselId" data-bs-slide-to="1"></li>
            <li data-bs-target="#carouselId" data-bs-slide-to="2"></li>
        </ol>
        <div class="carousel-inner" role="listbox">
            <div class="carousel-item active">
                <img src="https://media.assettype.com/sunstar%2Fimport%2Fuploads%2Fimages%2F2021%2F11%2F07%2F321444.jpeg?w=480&auto=format%2Ccompress&fit=max" class="img-fluid" alt="Image">
                <div class="carousel-caption">
                    <div class="p-3" style="max-width: 900px;">
                        <h4 class="text-white text-uppercase fw-bold mb-4" style="letter-spacing: 3px;">Empowering the Environment of</h4>
                        <h1 class="display-1 text-capitalize text-white mb-4">BRGY. BABAG</></h1>
                        <p class="mb-5 fs-5">
                            Transparency, Efficiency, and Community Engagement.
                        </p>
                        <div class="d-flex align-items-center justify-content-center">
                            <a class="btn-hover-bg btn btn-primary text-white py-3 px-5" style="background: #70c778 !important;" href="~/Home/Organization">See our organization team</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img src="~/images/babagLandscape2.png" class="img-fluid" alt="Image">
                <div class="carousel-caption">
                    <div class="p-3" style="max-width: 900px;">
                        <h4 class="text-white text-uppercase fw-bold mb-4" style="letter-spacing: 3px;">Help us clean Brgy. Babag!</h4>
                        <h1 class="display-1 text-capitalize text-white mb-4">Green Initiatives</h1>
                        <p class="mb-5 fs-5">
                            Receive email notifications to notify you for the garbage collection schedule.
                        </p>
                        <div class="d-flex align-items-center justify-content-center">
                            <a class="btn-hover-bg btn btn-primary text-white py-3 px-5" style="background: #70c778 !important;" href="~/Home/WasteManagement">Waste Management</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img src="~/images/babagLandscape1.png" class="img-fluid" alt="Image">
                <div class="carousel-caption">
                    <div class="p-3" style="max-width: 900px;">
                        <h4 class="text-white text-uppercase fw-bold mb-4" style="letter-spacing: 3px;">Join in our Programs/Events</h4>
                        <h1 class="display-1 text-capitalize text-white mb-4">Be a Participant!</h1>
                        <p class="mb-5 fs-5">
                            View, feedback, and comment on programs in our Baranggay! 
                        </p>
                        <div class="d-flex align-items-center justify-content-center">
                            <a class="btn-hover-bg btn btn-primary text-white py-3 px-5" style="background: #70c778 !important;" href="~/Home/CommunityInvolvementPrograms">Programs/Events</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselId" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselId" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>
<!-- Carousel End -->
<div class="container-fluid about py-5">
    <div class="container py-5">
        <div class="row g-5">
            <!-- Image Section -->
            <div class="col-xl-5">
                <div class="h-100">
                    <img src="~/images/babagPortrait.jpg" class="img-fluid w-100 h-100" alt="Babag Image">
                </div>
            </div>

            <!-- Content Section -->
            <div class="col-xl-7">
                <h5 class="text-uppercase text-primary">About Barangay Babag</h5>
                <h1 class="mb-4">Barangay in Lapu-Lapu City</h1>
                <p class="fs-5 mb-4">
                    Babag is one of the barangays of Lapu-Lapu City, known for its growing population and vibrant community. As of the 2020 Census, the population of Babag was <strong>30,839</strong>, with an area of <strong>3.778 km²</strong> and a population density of <strong>8,163/km²</strong>.
                </p>
                <p class="fs-5 mb-4">
                    Babag has experienced a <strong>6.6% annual population growth</strong> between 2015 and 2020, reflecting its development and urbanization over the years.
                </p>

                <!-- Tabbed Section -->
                <div class="tab-class bg-secondary p-4">
                    <ul class="nav d-flex mb-2">
                        <li class="nav-item mb-3">
                            <a class="d-flex py-2 text-center bg-white active" data-bs-toggle="pill" href="#about-babag">
                                <span class="text-dark" style="width: 150px;">Overview</span>
                            </a>
                        </li>
                        <li class="nav-item mb-3">
                            <a class="d-flex py-2 mx-3 text-center bg-white" data-bs-toggle="pill" href="#mission-babag">
                                <span class="text-dark" style="width: 150px;">Mission</span>
                            </a>
                        </li>
                        <li class="nav-item mb-3">
                            <a class="d-flex py-2 text-center bg-white" data-bs-toggle="pill" href="#vision-babag">
                                <span class="text-dark" style="width: 150px;">Vision</span>
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <!-- Overview Tab -->
                        <div id="about-babag" class="tab-pane fade show p-0 active">
                            <h5 class="text-uppercase mb-3">Overview</h5>
                            <p class="mb-4">
                                Babag's development is supported by its close proximity to Lapu-Lapu City, making it a hub for community, education, and business growth. The barangay's leadership is committed to sustainable urban growth.
                            </p>
                        </div>

                        <!-- Mission Tab -->
                        <div id="mission-babag" class="tab-pane fade show p-0">
                            <h5 class="text-uppercase mb-3">Mission</h5>
                            <p class="mb-4">
                                To foster community development and provide quality public services that enhance the lives of all residents of Barangay Babag through GREEN INITIATIVES.
                            </p>
                        </div>

                        <!-- Vision Tab -->
                        <div id="vision-babag" class="tab-pane fade show p-0">
                            <h5 class="text-uppercase mb-3">Vision</h5>
                            <p class="mb-4">
                                To be a model barangay in sustainable growth and development, promoting harmony, prosperity, and a safe environment for all residents.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container about">
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="metric-card">
                <h5>Top 3 Events Based on Feedback</h5>
                <ul class="list-group">
                    @foreach (var eventItem in ViewBag.TopEvents as List<TopEvent>)
                    {
                        <li class="list-group-item">
                            <strong>Event Name:</strong> @eventItem.NameOfEvent<br>
                            <strong>Average Rating:</strong> @eventItem.AverageStar.Value.ToString("N1") ⭐
                            <strong>Facebook Link:</strong> <a href="@eventItem.Link.Split(",").FirstOrDefault()" target="_blank">@eventItem.Link.Split(",").FirstOrDefault()</a>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid about py-5">

    <div class="container mt-5 metric-card">
        <h2>Incident Frequency (December 2023 - Present)</h2>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Location</th>
                    <th>Type of Incident</th>
                    <th>Frequency</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var incident in ViewBag.Incidents as List<IncidentFrequency>)
                {
                    <tr>
                        <td>@incident.Location</td>
                        <td>@incident.TypeOfIncident</td>
                        <td>@incident.Frequency</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>


@if (announcementMessage != null)
{
    <script>
        $(document).ready(function () {
            // Trigger the announcement popup if ViewBag.Announcement is not null
            showAnnouncement('Announcment from Official: @announcementMessage');
        });
    </script>
}
<div id="announcement-popup" class="announcement-popup">
    <div class="popup-content">
        <button id="close-popup" class="close-btn">&times;</button>
        <p id="announcement-text">This is an announcement message!</p>
    </div>
</div>

<script>
    // Show announcement popup
    function showAnnouncement(message) {
        const popup = document.getElementById("announcement-popup");
        const announcementText = document.getElementById("announcement-text");

        // Set the message for the announcement
        announcementText.textContent = message;

        // Make the popup appear
        popup.classList.add("show");

        // Auto hide the popup after 5 seconds
        setTimeout(() => {
            popup.classList.remove("show");
        }, 10000); // Hide after 5 seconds
    }

    // Close button functionality
    document.getElementById("close-popup").addEventListener("click", function () {
        const popup = document.getElementById("announcement-popup");
        popup.classList.remove("show");
    });

</script>